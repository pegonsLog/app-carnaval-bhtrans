<div class="modal-overlay" (click)="fecharModal()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header no-print">
      <h2>Documento Belotur</h2>
      <div class="header-actions">
        <button class="print-btn" (click)="imprimir()" title="Imprimir">
          <ng-icon name="heroPrinter"></ng-icon>
          Imprimir
        </button>
        <button class="close-btn" (click)="fecharModal()">
          <ng-icon name="heroXMark"></ng-icon>
        </button>
      </div>
    </div>

    <div class="document-wrapper">
      <div class="a4-document">
        <!-- Cabeçalho do Documento -->
        <div class="doc-header">
          <div class="logo-section">
            <img src="assets/images/logo-belotur.png" alt="Belotur" class="logo" onerror="this.style.display='none'">
          </div>
          <div class="header-text">
            <h1>DADOS EXTRAÍDOS DA PLANILHA DA BELOTUR</h1>
            <p class="subtitle">Carnaval de Belo Horizonte - Ficha Cadastral do Bloco</p>
          </div>
        </div>

        <div class="doc-divider"></div>

        <!-- Informações do Bloco -->
        <section class="doc-section">
          <h3 class="section-title">IDENTIFICAÇÃO DO BLOCO</h3>
          <div class="info-grid">
            <div class="info-item full">
              <span class="label">Nome do Bloco:</span>
              <span class="value">{{ bloco.nomeDoBloco || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Nº Inscrição:</span>
              <span class="value">{{ bloco.numeroInscricao || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Categoria:</span>
              <span class="value">{{ bloco.categoriaDoBloco || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Período:</span>
              <span class="value">{{ bloco.periodo || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Regional:</span>
              <span class="value">{{ bloco.regional || '-' }}</span>
            </div>
          </div>
        </section>

        <!-- Características -->
        <section class="doc-section">
          <h3 class="section-title">CARACTERÍSTICAS</h3>
          <div class="info-grid">
            <div class="info-item">
              <span class="label">Perfil:</span>
              <span class="value">{{ bloco.perfil || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Estilo Musical:</span>
              <span class="value">{{ bloco.estiloDeMusica || '-' }}</span>
            </div>
            <div class="info-item full">
              <span class="label">Descrição:</span>
              <span class="value">{{ bloco.descricaoDoBloco || '-' }}</span>
            </div>
          </div>
        </section>

        <!-- Data e Horários -->
        <section class="doc-section">
          <h3 class="section-title">DATA E HORÁRIOS DO DESFILE</h3>
          <div class="info-grid">
            <div class="info-item">
              <span class="label">Data do Desfile:</span>
              <span class="value">{{ formatDate(bloco.dataDoDesfile) }}</span>
            </div>
            <div class="info-item">
              <span class="label">Concentração:</span>
              <span class="value">{{ bloco.horarioDeconcentracao || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Início:</span>
              <span class="value">{{ bloco.inicioDoDesfile || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Encerramento:</span>
              <span class="value">{{ bloco.horarioEncerramento || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Duração:</span>
              <span class="value">{{ bloco.duracaoDoDesfile || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Dispersão:</span>
              <span class="value">{{ bloco.horarioDispersao || '-' }}</span>
            </div>
          </div>
        </section>

        <!-- Percurso -->
        <section class="doc-section">
          <h3 class="section-title">PERCURSO E LOCALIZAÇÃO</h3>
          <div class="info-grid">
            <div class="info-item full">
              <span class="label">Percurso:</span>
              <span class="value">{{ bloco.percurso || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">End. Concentração:</span>
              <span class="value">{{ bloco.enderecoDeConcentracao || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Bairro Concentração:</span>
              <span class="value">{{ bloco.bairroDeConcentracao || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">End. Dispersão:</span>
              <span class="value">{{ bloco.enderecoDeDispersao || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Bairro Dispersão:</span>
              <span class="value">{{ bloco.bairroDeDispersao || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Extensão:</span>
              <span class="value">{{ formatNumber(bloco.extensaoDoDesfileMetros) }} m</span>
            </div>
            <div class="info-item">
              <span class="label">Nº de Quadras:</span>
              <span class="value">{{ bloco.numeroDeQuadras || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Área do Trajeto:</span>
              <span class="value">{{ formatNumber(bloco.areaDoTrajetoM2) }} m²</span>
            </div>
            <div class="info-item">
              <span class="label">Capacidade:</span>
              <span class="value">{{ formatNumber(bloco.capacidadePublicoDoTrajeto) }} pessoas</span>
            </div>
          </div>
        </section>

        <!-- Público -->
        <section class="doc-section">
          <h3 class="section-title">PÚBLICO ESTIMADO</h3>
          <div class="info-grid">
            <div class="info-item">
              <span class="label">Público Anterior:</span>
              <span class="value">{{ formatNumber(bloco.publicoAnterior) }}</span>
            </div>
            <div class="info-item">
              <span class="label">Público Declarado:</span>
              <span class="value">{{ formatNumber(bloco.publicoDeclarado) }}</span>
            </div>
            <div class="info-item full">
              <span class="label">Observações Ano Anterior:</span>
              <span class="value">{{ bloco.observacoesAnoAnterior || '-' }}</span>
            </div>
          </div>
        </section>

        <!-- Equipamentos -->
        <section class="doc-section">
          <h3 class="section-title">EQUIPAMENTOS E DIMENSÕES</h3>
          <div class="info-grid">
            <div class="info-item full">
              <span class="label">Equipamentos:</span>
              <span class="value">{{ formatArray(bloco.equipamentosUtilizados) }}</span>
            </div>
            <div class="info-item">
              <span class="label">Largura:</span>
              <span class="value">{{ bloco.larguraMetros || '-' }} m</span>
            </div>
            <div class="info-item">
              <span class="label">Comprimento:</span>
              <span class="value">{{ bloco.comprimentoMetros || '-' }} m</span>
            </div>
            <div class="info-item">
              <span class="label">Altura:</span>
              <span class="value">{{ bloco.alturaMetros || '-' }} m</span>
            </div>
            <div class="info-item">
              <span class="label">Potência:</span>
              <span class="value">{{ formatNumber(bloco.potenciaWatts) }} W</span>
            </div>
            <div class="info-item full">
              <span class="label">Dimensão de Veículos:</span>
              <span class="value">{{ bloco.dimensaoDeVeiculos || '-' }}</span>
            </div>
          </div>
        </section>

        <!-- Responsável -->
        <section class="doc-section">
          <h3 class="section-title">RESPONSÁVEL LEGAL</h3>
          <div class="info-grid">
            <div class="info-item full">
              <span class="label">Nome:</span>
              <span class="value">{{ bloco.responsavelLegal || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">CPF:</span>
              <span class="value">{{ bloco.cpf || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">CNPJ:</span>
              <span class="value">{{ bloco.cnpj || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">E-mail:</span>
              <span class="value">{{ bloco.email || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Telefone:</span>
              <span class="value">{{ bloco.telefone || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Celular:</span>
              <span class="value">{{ bloco.celular || '-' }}</span>
            </div>
          </div>
        </section>

        <!-- Responsável Secundário -->
        <section class="doc-section" *ngIf="bloco.nomeResponsavelSecundario">
          <h3 class="section-title">RESPONSÁVEL SECUNDÁRIO</h3>
          <div class="info-grid">
            <div class="info-item">
              <span class="label">Nome:</span>
              <span class="value">{{ bloco.nomeResponsavelSecundario || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Celular:</span>
              <span class="value">{{ bloco.celularContato2 || '-' }}</span>
            </div>
          </div>
        </section>

        <!-- Status -->
        <section class="doc-section">
          <h3 class="section-title">STATUS</h3>
          <div class="info-grid">
            <div class="info-item">
              <span class="label">Possui Desfiles:</span>
              <span class="value">{{ formatBoolean(bloco.possuiDesfiles) }}</span>
            </div>
            <div class="info-item">
              <span class="label">Status do Desfile:</span>
              <span class="value">{{ bloco.statusDoDesfile || '-' }}</span>
            </div>
            <div class="info-item">
              <span class="label">Autoriza Divulgação:</span>
              <span class="value">{{ formatBoolean(bloco.autorizaDivulgacao) }}</span>
            </div>
            <div class="info-item">
              <span class="label">Primeiro Cadastro:</span>
              <span class="value">{{ formatBoolean(bloco.primeiroCadastro) }}</span>
            </div>
            <div class="info-item full" *ngIf="bloco.justificativaStatus">
              <span class="label">Justificativa:</span>
              <span class="value">{{ bloco.justificativaStatus }}</span>
            </div>
            <div class="info-item full" *ngIf="bloco.informacoesAdicionais">
              <span class="label">Informações Adicionais:</span>
              <span class="value">{{ bloco.informacoesAdicionais }}</span>
            </div>
          </div>
        </section>

        <!-- Rodapé -->
        <div class="doc-footer">
          <p>Data de Cadastro/Modificação: {{ formatDate(bloco.dataCadastroModificacao) }}</p>
          <p class="footer-note">Documento gerado pelo Sistema de Gestão do Carnaval de BH - Belotur</p>
        </div>
      </div>
    </div>
  </div>
</div>
