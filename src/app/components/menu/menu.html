<div class="menu-container">
  <h2 class="menu-titulo">Buscar Blocos</h2>
  
  <div class="cards-container">
    <!-- Card Por Bloco -->
    <div class="menu-card" (click)="abrirModalPorBloco()">
      <div class="card-icon">
        <ng-icon name="heroMagnifyingGlass"></ng-icon>
      </div>
      <span class="card-titulo">Por Bloco</span>
      <span class="card-descricao">Busque pelo nome do bloco</span>
    </div>

    <!-- Card Por Regional -->
    <div class="menu-card" (click)="abrirModalPorRegional()">
      <div class="card-icon">
        <ng-icon name="heroBuildingOffice2"></ng-icon>
      </div>
      <span class="card-titulo">Por Regional</span>
      <span class="card-descricao">Filtre por regional</span>
    </div>

    <!-- Card Por Data -->
    <div class="menu-card" (click)="abrirModalPorData()">
      <div class="card-icon">
        <ng-icon name="heroCalendarDays"></ng-icon>
      </div>
      <span class="card-titulo">Por Data</span>
      <span class="card-descricao">Filtre por data do desfile</span>
    </div>
  </div>
</div>

<!-- Modal Por Bloco -->
<div class="modal-overlay" *ngIf="modalPorBlocoAberto" (click)="fecharModalPorBloco()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Buscar Por Bloco</h3>
      <button class="btn-fechar" (click)="fecharModalPorBloco()">
        <ng-icon name="heroXMark"></ng-icon>
      </button>
    </div>
    <div class="modal-body">
      <div class="filtro-grupo">
        <label>Nome do Bloco</label>
        <input type="text" [(ngModel)]="filtroBlocoNome" (input)="filtrarPorBloco()" 
               placeholder="Digite o nome do bloco..." class="input-filtro">
      </div>
      <div class="lista-blocos" *ngIf="blocosFiltrados.length > 0">
        <div class="bloco-card" *ngFor="let bloco of blocosFiltrados">
          <div class="bloco-info">
            <span class="bloco-nome">{{ bloco.nomeDoBloco }}</span>
            <span class="bloco-data">{{ formatarData(bloco.dataDoDesfile) }}</span>
          </div>
          <div class="bloco-acoes">
            <button class="btn-acao" (click)="abrirMapa(bloco)" [disabled]="!temMapa(bloco)" title="Ver Mapa">
              <ng-icon name="heroMap"></ng-icon>
            </button>
            <button class="btn-acao" (click)="abrirDocumentoCompleto(bloco)" title="Documento Completo">
              <ng-icon name="heroDocumentText"></ng-icon>
            </button>
          </div>
        </div>
      </div>
      <div class="sem-resultados" *ngIf="filtroBlocoNome && blocosFiltrados.length === 0">
        Nenhum bloco encontrado
      </div>
    </div>
  </div>
</div>

<!-- Modal Por Regional -->
<div class="modal-overlay" *ngIf="modalPorRegionalAberto" (click)="fecharModalPorRegional()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Buscar Por Regional</h3>
      <button class="btn-fechar" (click)="fecharModalPorRegional()">
        <ng-icon name="heroXMark"></ng-icon>
      </button>
    </div>
    <div class="modal-body">
      <div class="filtro-grupo">
        <label>Regional</label>
        <select [(ngModel)]="filtroRegional" (change)="filtrarPorRegional()" class="select-filtro">
          <option value="">Selecione uma regional</option>
          <option *ngFor="let regional of regionais" [value]="regional">{{ regional }}</option>
        </select>
      </div>
      <div class="filtro-grupo">
        <label>Nome do Bloco (opcional)</label>
        <input type="text" [(ngModel)]="filtroRegionalNome" (input)="filtrarPorRegional()" 
               placeholder="Filtrar por nome..." class="input-filtro">
      </div>
      <div class="lista-blocos" *ngIf="blocosFiltrados.length > 0">
        <div class="bloco-card" *ngFor="let bloco of blocosFiltrados">
          <div class="bloco-info">
            <span class="bloco-nome">{{ bloco.nomeDoBloco }}</span>
            <span class="bloco-data">{{ formatarData(bloco.dataDoDesfile) }}</span>
          </div>
          <div class="bloco-acoes">
            <button class="btn-acao" (click)="abrirMapa(bloco)" [disabled]="!temMapa(bloco)" title="Ver Mapa">
              <ng-icon name="heroMap"></ng-icon>
            </button>
            <button class="btn-acao" (click)="abrirDocumentoCompleto(bloco)" title="Documento Completo">
              <ng-icon name="heroDocumentText"></ng-icon>
            </button>
          </div>
        </div>
      </div>
      <div class="sem-resultados" *ngIf="(filtroRegional || filtroRegionalNome) && blocosFiltrados.length === 0">
        Nenhum bloco encontrado
      </div>
    </div>
  </div>
</div>

<!-- Modal Por Data -->
<div class="modal-overlay" *ngIf="modalPorDataAberto" (click)="fecharModalPorData()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Buscar Por Data</h3>
      <button class="btn-fechar" (click)="fecharModalPorData()">
        <ng-icon name="heroXMark"></ng-icon>
      </button>
    </div>
    <div class="modal-body">
      <div class="filtro-grupo">
        <label>Data do Desfile</label>
        <select [(ngModel)]="filtroData" (change)="filtrarPorData()" class="select-filtro">
          <option value="">Selecione uma data</option>
          <option *ngFor="let data of datas" [value]="data">{{ data }}</option>
        </select>
      </div>
      <div class="filtro-grupo">
        <label>Nome do Bloco (opcional)</label>
        <input type="text" [(ngModel)]="filtroDataNome" (input)="filtrarPorData()" 
               placeholder="Filtrar por nome..." class="input-filtro">
      </div>
      <div class="lista-blocos" *ngIf="blocosFiltrados.length > 0">
        <div class="bloco-card" *ngFor="let bloco of blocosFiltrados">
          <div class="bloco-info">
            <span class="bloco-nome">{{ bloco.nomeDoBloco }}</span>
            <span class="bloco-data">{{ formatarData(bloco.dataDoDesfile) }}</span>
          </div>
          <div class="bloco-acoes">
            <button class="btn-acao" (click)="abrirMapa(bloco)" [disabled]="!temMapa(bloco)" title="Ver Mapa">
              <ng-icon name="heroMap"></ng-icon>
            </button>
            <button class="btn-acao" (click)="abrirDocumentoCompleto(bloco)" title="Documento Completo">
              <ng-icon name="heroDocumentText"></ng-icon>
            </button>
          </div>
        </div>
      </div>
      <div class="sem-resultados" *ngIf="(filtroData || filtroDataNome) && blocosFiltrados.length === 0">
        Nenhum bloco encontrado
      </div>
    </div>
  </div>
</div>

<!-- Modal do Mapa -->
<app-mapa-modal *ngIf="modalMapaAberto" [url]="mapaUrl" [titulo]="mapaTitulo" (fechar)="fecharMapa()"></app-mapa-modal>
