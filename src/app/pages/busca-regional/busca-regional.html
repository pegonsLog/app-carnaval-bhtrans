<div class="page-container">
    <div class="page-header">
        <button class="btn-voltar" (click)="voltar()">
            <ng-icon name="heroArrowLeft"></ng-icon>
        </button>
        <h2>Buscar Por Regional</h2>
    </div>

    <div class="page-content">
        <!-- Indicador de carregamento -->
        <div class="loading-message" *ngIf="carregando">
            Carregando regionais...
        </div>

        <!-- Mensagem de erro -->
        <div class="error-message" *ngIf="erro && !carregando">
            {{ erro }}
        </div>

        <div class="filtro-grupo">
            <label>Regional</label>
            <select [(ngModel)]="filtroRegional" (change)="filtrarPorRegional()" class="select-filtro" [disabled]="carregando || regionais.length === 0">
                <option value="">{{ carregando ? 'Carregando...' : (regionais.length === 0 ? 'Nenhuma regional disponível' : 'Selecione uma regional') }}</option>
                <option *ngFor="let regional of regionais" [value]="regional">{{ regional }}</option>
            </select>
            <small class="info-text" *ngIf="!carregando && regionais.length > 0">
                {{ regionais.length }} regionais disponíveis
            </small>
        </div>

        <div class="filtro-grupo">
            <label>Nome do Bloco (opcional)</label>
            <input type="text" [(ngModel)]="filtroRegionalNome" (input)="filtrarPorRegional()"
                placeholder="Filtrar por nome..." class="input-filtro">
        </div>

        <div class="lista-blocos" *ngIf="blocosFiltrados.length > 0">
            <div class="bloco-card" *ngFor="let bloco of blocosFiltrados">
                <div class="bloco-info">
                    <span class="bloco-nome">{{ bloco.nomeDoBloco }}</span>
                    <span class="bloco-data">{{ formatarData(bloco.dataDoDesfile) }}</span>
                </div>
                <div class="bloco-acoes">
                    <button class="btn-acao" (click)="abrirMapa(bloco)" [disabled]="!temMapa(bloco)" title="Ver Mapa">
                        <ng-icon name="heroMap"></ng-icon>
                    </button>
                    <button class="btn-acao" (click)="abrirDocumentoCompleto(bloco)" title="Documento Completo">
                        <ng-icon name="heroDocumentText"></ng-icon>
                    </button>
                </div>
            </div>
        </div>

        <div class="sem-resultados" *ngIf="(filtroRegional || filtroRegionalNome) && blocosFiltrados.length === 0">
            Nenhum bloco encontrado
        </div>
    </div>
</div>