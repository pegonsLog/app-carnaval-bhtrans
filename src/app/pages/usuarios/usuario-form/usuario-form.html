<div class="form-container">
    <div class="header">
        <button class="btn-voltar" (click)="voltar()">← Voltar</button>
        <h1>{{ editando ? 'Editar' : 'Novo' }} Usuário</h1>
    </div>

    <div class="loading" *ngIf="carregando">
        Carregando...
    </div>

    <div class="form-card" *ngIf="!carregando">
        <div class="mensagem-erro" *ngIf="mensagemErro">
            {{ mensagemErro }}
        </div>

        <form [formGroup]="form" (ngSubmit)="salvar()">
            <div class="form-group">
                <label for="matricula">Matrícula *</label>
                <input type="text" id="matricula" formControlName="matricula" placeholder="Digite a matrícula">
                <div class="error" *ngIf="form.get('matricula')?.invalid && form.get('matricula')?.touched">
                    Matrícula é obrigatória
                </div>
            </div>

            <div class="form-group">
                <label for="senha">Senha {{ editando ? '' : '*' }}</label>
                <input type="password" id="senha" formControlName="senha"
                    [placeholder]="editando ? 'Deixe em branco para manter a atual' : 'Digite a senha'">
                <div class="error" *ngIf="form.get('senha')?.invalid && form.get('senha')?.touched">
                    Senha é obrigatória
                </div>
            </div>

            <div class="form-group">
                <label for="area">Área *</label>
                <select id="area" formControlName="area">
                    <option value="">Selecione a área</option>
                    <option value="GARBO">GARBO (Oeste / Barreiro)</option>
                    <option value="GARNP">GARNP (Noroeste / Pampulha)</option>
                    <option value="GARNE">GARNE (Nordeste / Norte)</option>
                    <option value="GARVN">GARVN (Norte / Venda Nova)</option>
                    <option value="GEACE">GEACE (Centro-Sul / Hipercentro)</option>
                    <option value="OUTRAS">OUTRAS (Todas)</option>
                </select>
                <div class="error" *ngIf="form.get('area')?.invalid && form.get('area')?.touched">
                    Área é obrigatória
                </div>
            </div>

            <div class="form-group">
                <label for="perfil">Perfil *</label>
                <select id="perfil" formControlName="perfil">
                    <option value="">Selecione o perfil</option>
                    <option value="admin">Administrador</option>
                    <option value="operador">Operador</option>
                    <option value="visualizador">Visualizador</option>
                </select>
                <div class="error" *ngIf="form.get('perfil')?.invalid && form.get('perfil')?.touched">
                    Perfil é obrigatório
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="btn-cancelar" (click)="voltar()">Cancelar</button>
                <button type="submit" class="btn-salvar" [disabled]="salvando || form.invalid">
                    {{ salvando ? 'Salvando...' : 'Salvar' }}
                </button>
            </div>
        </form>
    </div>
</div>
